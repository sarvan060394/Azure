apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: cubes-http-request-alert
  namespace: your-namespace
spec:
  groups:
    - name: cubes-http-alerts
      rules:
        - alert: HighHttpRequestRate
          expr: rate(http_server_requests_seconds_count{app="cubes"}[1m]) > 50
          for: 1m
          labels:
            severity: warning
            alertname: HighHttpRequestRate
          annotations:
            summary: "High HTTP request rate for cubes"
            description: "The cubes app is receiving more than 50 requests per minute in pod {{ $labels.pod }}."

count(
  kube_pod_status_phase{phase="Running", namespace="cp-1049543"}
  * on(pod) group_left()
  kube_pod_info{pod=~"kubes-data-connect-mongodb.*"}
)

- alert: NoRunningPodsForKubesDataConnectMongoDB
  expr: absent(kube_pod_status_phase{phase="Running", namespace="cp-1049543", pod=~"kubes-data-connect-mongodb.*"})
  for: 1m
  labels:
    severity: critical
  annotations:
    summary: "No running pods for kubes-data-connect-mongodb"
    description: "No running pods detected for kubes-data-connect-mongodb in namespace cp-1049543."

